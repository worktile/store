@if (todos$ | async; as todos) {
  <section class="todoapp">
    <header class="header">
      <h1>todos</h1>
      <input class="new-todo" placeholder="What needs to be done?" autofocus="" [(ngModel)]="newTodoText" (keyup.enter)="addTodo()" />
    </header>
    @if (todos && todos.length > 0) {
      <section class="main">
        @if (todos.length) {
          <input
            id="toggle-all"
            class="toggle-all"
            type="checkbox"
            #toggleAll
            [checked]="todosStore.allCompleted()"
            (click)="todosStore.setAllTo(toggleAll.checked)"
          />
        }
        <ul class="todo-list">
          @for (todo of todos; track todo.id) {
            <li [class.completed]="todo.completed" [class.editing]="todo.editing">
              <div class="view">
                <input class="toggle" type="checkbox" (click)="toggleCompletion(todo)" [checked]="todo.completed" />
                <label (dblclick)="editTodo(todo)">{{ todo.title }}</label>
                <button class="destroy" (click)="remove(todo)"></button>
              </div>
              @if (todo.editing) {
                <input
                  class="edit"
                  [value]="todo.title"
                  #editor
                  (blur)="stopEditing(todo, editor.value)"
                  (keyup.enter)="update(todo, editor.value)"
                  (keyup.escape)="cancelEditingTodo(todo)"
                />
              }
            </li>
          }
        </ul>
      </section>
    }
    @if (todos.length > 0) {
      <footer class="footer">
        <span class="todo-count"
          ><strong>{{ todosStore.getRemaining().length }}</strong>
          {{ todosStore.getRemaining().length === 1 ? 'item' : 'items' }} left</span
        >
        @if (todosStore.getCompleted().length > 0) {
          <button class="clear-completed" (click)="removeCompleted()">Clear completed</button>
        }
      </footer>
    }
  </section>
}
